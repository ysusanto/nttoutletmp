<?php
/*
* Copyright (C) Incevio Systems, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Munna Khan <help.zcart@gmail.com>, September 2018
*/
 namespace App\Http\Middleware; use Auth; use View; use Closure; use App\Helpers\ListHelper; use Illuminate\Support\Facades\Cache; class InitSettings { public function handle($request, Closure $next) { if (!$request->is("\x69\x6e\163\164\141\154\x6c\52")) { goto jDoaO; } return $next($request); jDoaO: setSystemConfig(); View::addNamespace("\x74\150\145\155\145", theme_views_path()); if (!Auth::guard("\167\x65\142")->check()) { goto kQstp; } if ($request->is("\141\144\155\151\x6e\x2f\52") || $request->is("\x61\x63\x63\x6f\x75\x6e\164\x2f\52")) { goto yfYNM; } return $next($request); goto JPHZF; yfYNM: $this->can_load(); JPHZF: if (!$request->session()->has("\151\x6d\160\x65\x72\163\x6f\156\141\164\x65\144")) { goto CAQQy; } Auth::onceUsingId($request->session()->get("\x69\x6d\x70\x65\162\163\x6f\156\141\x74\x65\x64")); CAQQy: if (!(!Auth::guard("\x77\145\x62")->user()->isFromPlatform() && Auth::guard("\x77\x65\x62")->user()->merchantId())) { goto bwXtH; } setShopConfig(Auth::guard("\x77\145\x62")->user()->merchantId()); bwXtH: $permissions = Cache::remember("\160\145\162\155\151\163\x73\151\x6f\x6e\x73", system_cache_remember_for(), function () { return ListHelper::authorizations(); }); $permissions = isset($extra_permissions) ? array_merge($extra_permissions, $permissions) : $permissions; config()->set("\x70\145\162\x6d\x69\163\163\151\157\156\x73", $permissions); if (!Auth::guard("\x77\145\142")->user()->isSuperAdmin()) { goto ihhms; } $slugs = Cache::remember("\163\x6c\165\147\163", system_cache_remember_for(), function () { return ListHelper::slugsWithModulAccess(); }); config()->set("\x61\x75\x74\x68\123\x6c\165\147\163", $slugs); ihhms: kQstp: return $next($request); } private function can_load() { if (!(ZCART_MIX_KEY != "\60\x31\x37\142\146\x38\x62\x63\x38\70\65\146\x62\63\x37\x62" || md5_file(base_path() . "\57\142\x6f\157\164\x73\164\162\x61\160\57\x61\165\x74\x6f\154\157\x61\x64\56\x70\150\160") != "\141\60\71\63\x64\67\x32\x38\146\141\62\66\146\144\70\60\x34\x65\61\60\x64\66\x63\x62\63\67\144\61\141\64\x31\146")) { goto Uouot; } die("\x44\151\144\x20\171\157\x75\40" . "\162\145\x6d\157\166\x65\40\164\150\145\40" . "\157\154\x64\40\146\151\154\145\163\x20" . "\x21\77"); Uouot: incevioAutoloadHelpers(getMysqliConnection()); } }